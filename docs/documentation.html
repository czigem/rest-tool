<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Get Help to the rest-tool.">
    <meta name="author" content="Tamás Benke">
    <meta name="Keywords" content="rest, restful, utility, tools, rest-tool, node.js, api, development" />
    <link rel="shortcut icon" href="../../assets/ico/favicon.ico">

    <title>rest-tool</title>

    <!-- Bootstrap core CSS -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="jumbotron-narrow.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="container">
      <div class="header">
        <ul class="nav nav-pills pull-right">
          <li><a href="../index.html">Home</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="getStarted.html">Get Started</a></li>
          <li><a href="documentation.html">Documentation</a></li>
          <li><a href="http://tombenke.github.io/rest-tool-cookbook/">Examples</a></li>
          <li><a href="getHelp.html">Get Help</a></li>
        </ul>
        <h3 class="text-muted">rest-tool</h3>
      </div>

      <div class="row marketing">
        <div class="col-lg-12">
          <h1 id="the-rest-tool-documentation">The rest-tool documentation</h1>
<h2 id="create-and-maintain-api-projects">Create and maintain API projects</h2>
<h3 id="create-new-projects">Create new projects</h3>
<p>In order to generate a new REST API project, execute the following command:</p>
<pre><code>$ rest-tool create &lt;project-name&gt;
</code></pre><p>for example:</p>
<pre><code>$ rest-tool create crm-api
</code></pre><p>After, you have created the new project, move into the new projects folder, 
and install those node modules, the new project needs:</p>
<pre><code>$ cd crm-api
$ npm install
</code></pre><p>Now the project is ready to define new services, to run and test them, as well as to generate HTML documentation of them.</p>
<h3 id="the-structure-of-a-project">The structure of a project</h3>
<p>The REST API project layout generated by the <code>rest-tool</code> utility looks like this:</p>
<pre><code>crm-api/
├── docs
├── server
├── services
│   └── monitoring
│       └── isAlive
├── templates
│   ├── docs
│   │   ├── images
│   │   ├── js
│   │   │   └── jquery-1.9.0
│   │   ├── sass
│   │   │   └── partials
│   │   └── stylesheets
│   ├── server
│   ├── services
│   │   ├── COLLECTION
│   │   ├── OPERATION
│   │   └── RESOURCE
│   └── test
└── test
</code></pre><p>In most of the cases the configuration files, service descriptors and even the schema files are writtem in <a href="http://en.wikipedia.org/wiki/YAML">YAML</a> format. Contentwise YAML fully covers the capabilities of JSON but it is a more human readable format. Also it offers some extra features that JSON can not provide, such as referencing reusable content, which helps to avoid unnecessary copy-paste.</p>
<p>The role of the of the directories and files:</p>
<ul>
<li><p><strong>config.yml</strong> :<br>  It holds the configuration parameters of the REST API project. 
  See below the detailed description of the format of this file.</p>
</li>
<li><p><strong>server</strong> :<br>  This folder contains the mock server with the mock implementation of the API.</p>
</li>
<li><p><strong>services</strong> :<br>  This folder contains the service descriptors. Each service should be put into its own subfolder, and must have a <code>service.yml</code> file in it. All the other supplementary files, which belongs to the specific service, and used to the specification must be put here, beside the <code>service.yml</code> file. Such files are for example the test-data and schema files.</p>
<p>  The service implementation files, which are referred by the <code>service.yml</code> via the <code>implementation</code> fields should be put beside the server code, and not here.</p>
</li>
<li><p><strong>docs</strong> :<br>  Contains the HTML format documentation of the REST API. This folder will be totally removed, and recreated during updating the documentation, so you should not modify its content manually.</p>
</li>
<li><p><strong>templates</strong> :<br>  This holds the customizable templates used by the documentation generator and the test case generator.</p>
</li>
<li><p><strong>templates/docs</strong> :<br>  Documentation templates, stylesheets, and images that the tool is using to create the HTML format documentation. They are written in <a href="https://github.com/raycmorgan/Mu">Mustache</a> format, using partials.</p>
<p>  The stylesheet is based on <a href="http://sass-lang.com/">sass</a>/<a href="http://compass-style.org/">compass</a>. If you want to change the CSS, modify the files under the <code>templates/docs/sass</code> directory.</p>
</li>
<li><p><strong>templates/test</strong> :<br>  JavaScript test-case (<a href="https://github.com/raycmorgan/Mu">Mustache</a>) templates to generate unit test code, which will run with mocha and supertest. These are referred from the service descriptors by their names. You can put here any number of additional templates.</p>
</li>
<li><p><strong>templates/services</strong> :<br>  Service descriptor templates in YAML format organized by the three main classes of services: COLLECTION, RESOURCE and OPERATION. Each stereotype has its own subdirectory, containing the <code>service.yml</code> template as well as some predefined test data files.</p>
</li>
<li><p><strong>test</strong> :<br>  The test cases generated by the <code>rest-tool</code> utility using the service descriptors, and the referred templates.</p>
</li>
<li><p><strong>Makefile</strong> :<br>  Makefile to run the test cases. Used by <a href="http://visionmedia.github.io/mocha/">mocha</a> and <a href="http://jenkins-ci.org/">Jenkins</a>.</p>
</li>
</ul>
<p>In general, you can modify the content of the files and folders the <code>rest-tool create</code> command made, except the files in <code>docs</code> and the <code>test</code> folders, because these will be created and later overwritten by the <code>rest-tool</code> command. If you want to modify the working of the test-cases, the server api implementation or the look-and-feel of the generated documents, you should mostly make changes under the <code>templates</code> and <code>server</code> directories, and of course you will create the service descriptions under the <code>services</code> folder.</p>
<h3 id="the-config-yml-file">The <code>config.yml</code> file</h3>
<p>This is the default <code>config.yml</code> file created for a new API project:</p>
<pre><code>projectName: the-name-of-the-new-project
apiVersion: v0.0.0
author: TBD.
licence: TBD.
serviceUrlPrefix: /rest
servicePort: 3007
baseUrl: http://localhost:3007/rest
servicesRoot: services
services:
    - /monitoring/isAlive
    # To add new services, put here the path of the directory
    # that contains the service.yml

loginCredentials:
    user: username
    pass: password
</code></pre><p>To see the detailed schema specification of the <code>config.yml</code> see the <a href="https://github.com/tombenke/rest-tool-common/blob/master/schemas/serviceConfigSchema.yml">serviceConfigSchema.yml</a> file, defined in the <code>rest-tool-common</code> module.</p>
<h3 id="upgrade-an-existing-api-project">Upgrade an existing API project</h3>
<p>Currently the <code>rest-tool</code> is under intensive development. The content of the generated projects might change with the new versions. </p>
<p>A given project is generated to refer to a specific <code>rest-tool-common</code> module, which ensures that the project will work even the rest-tool is significantly changing, however it only guarantees that the server, and the previuously generated test cases will work.</p>
<p>In case you are upgrading to a new <code>rest-tool</code> version, the document generation and test case generation may not work any more with an older project. If you would like to leverage the new features, you have to upgrade your old project to the new version.</p>
<p>In order to do this, an <code>rest-tool upgrade</code> command will be developed soon.
Until it will be implemented, you can upgrade an old project executing the following steps:</p>
<ol>
<li>Install the newest version of the <code>rest-tool</code>.</li>
<li>Generate a new, empty project with the new version.</li>
<li>Replace the version of <code>rest-tool-common</code> in the old project&#39;s <code>package.json</code> with the new value found in the newly generated project&#39;s <code>package.json</code>.</li>
<li>Merge the new module dependencies might fuond in the new version of <code>package.json</code> to the old <code>projects&#39; package.json</code>.</li>
<li>Copy/merge the templates folder from the new project to the old project.</li>
<li>Copy/merge the server folder from the new project to the old project.</li>
<li>Merge the config.yml file from the new project to the config.yml file of the old project.</li>
<li>Regenerate the docs and test cases.</li>
</ol>
<h2 id="create-and-maintain-services">Create and maintain services</h2>
<h3 id="service-definitions">Service definitions</h3>
<p>The services can be specified under the <code>services</code> folder. Each service should have its own subdirectory. A service subdirectory must contain at least a <code>service.yml</code> descriptor file, and any other files, mainly JSON or XML mock data and validation schemas.</p>
<p>The newly created project contains a sample service descriptor such as <code>services/monitoring/isAlive/service.yml</code>.
Below you can see its (a bit shortened) content:</p>
<pre><code>name: Monitoring that server is alive
description: |
    It is a very simple service, 
    which makes possible to monitor that the server is running
    and is able to answer HTTP requests
style: OPERATION
urlPattern: /monitoring/isAlive
methods:
    GET:
        summary: Is server alive?
        notes: Responses true if server is working
        # implementation: monitoring.isAlive
        request:
            parameters: []
            cookies: []
            headers: []
        responses:
            -
                name: OK
                statusCode: &amp;OkStatusCode 200
                reason: &amp;OkReason Successful execution
                cookies: []
                headers: []
                mockBody: getMonitoringIsAlive-responseBody.json
        testCases:
            -
                name: Get Monitoring Is Alive
                description: Successfully checks if server is alive
                url: /monitoring/isAlive
                template: testGetMethod.mustache
                request:
                    parameters: []
                    cookies: []
                    headers: []
                response:
                    name: OK
                    statusCode: *OkStatusCode
                    reason: *OkReason
                    cookies: []
                    headers: []
</code></pre><p>The sample service descriptor defines a service, which is able to response to GET requests, and the response will be the content of the <code>getMonitoringIsAlive-responseBody.json</code> file placed into the same directory where the <code>service.yml</code> is there, as the <code>mockBody</code> property determines.</p>
<p>The response also could be dynamically created by implementing it in JavaScript. The <code>implementation</code> property of the request identifies the module and function of the code which defines the behaviour of the service. At the moment it is commented out using the <code>#</code> character, because only one of <code>mockBody</code> or <code>implementation</code> can exist.</p>
<p>This sample desciptor file also can be used as a baseline to write your own definitions. </p>
<h3 id="the-structure-of-the-service-yml-file">The structure of the service.yml file</h3>
<p>The top-level structure of a service descriptor is the following:</p>
<ul>
<li><p><strong>name:</strong><br>The name of the service.</p>
<p>For example: <code>Monitoring that server is alive</code></p>
</li>
<li><p><strong>description:</strong><br>Short desciption of the service.</p>
<p>For example: <code>It is a very simple service, which makes possible to...</code></p>
</li>
<li><p><strong>style:</strong><br>Tells whether it is an RPC-like OPERATION,
or a RESOURCE, which fully comply to the REST principles</p>
<p>Possible values: OPERATION | COLLECTION | RESOURCE</p>
</li>
<li><p><strong>urlPattern:</strong><br>The URL pattern of the service.</p>
<p>For example: <code>/monitoring/isAlive</code>.</p>
</li>
<li><p><strong>methods:</strong><br>The methods of the service specification.
There must be at least one method defined for the resource.</p>
<p>Currently only the most fundamental methods (GET, PUT, POST, DELETE) are provided</p>
</li>
</ul>
<p>The internal structure of every method is the following:</p>
<ul>
<li><p><strong>summary:</strong><br>  Short summary of the service method.</p>
</li>
<li><p><strong>notes:</strong><br>  Details and notes about the method.</p>
</li>
<li><p><strong>implementation:</strong><br>  The implementation of the call in the following format:
  <code>&lt;module&gt;.&lt;function&gt;</code> (optional).</p>
<p>  For example: <code>monitoring.isalive</code></p>
</li>
<li><p><strong>request:</strong><br>  The detailed specification of request.</p>
</li>
<li><p><strong>responses:</strong><br>  The detailed specification of responses.
  There can be several possible responses, 
  but at least one <code>OK</code> response must be defined.</p>
</li>
<li><p><strong>testCases:</strong><br>  The detailed specification of test cases.
  A method can contain zero or more test cases.</p>
</li>
</ul>
<p>In the whole service descriptor, you can use multiline text in case of string-type fields. moreover you can use <a href="http://daringfireball.net/projects/markdown/">Markdown</a> format text in fields named such as: &#39;description&#39;, &#39;summary&#39; and &#39;details&#39;.</p>
<p>TBD:</p>
<ul>
<li>request</li>
<li>responses</li>
<li>testCases</li>
</ul>
<p>To see the detailed structure description of the service descriptor file, study the corresponding JSON validation schema files:</p>
<ul>
<li><a href="https://github.com/tombenke/rest-tool-common/blob/master/schemas/serviceSchema.yml">serviceSchema.yml</a></li>
<li><a href="https://github.com/tombenke/rest-tool-common/blob/master/schemas/requestParametersSchema.yml">requestParametersSchema.yml</a></li>
<li><a href="https://github.com/tombenke/rest-tool-common/blob/master/schemas/headersSchema.yml">headersSchema.yml</a></li>
<li><a href="https://github.com/tombenke/rest-tool-common/blob/master/schemas/cookiesSchema.yml">cookiesSchema.yml</a></li>
<li><a href="https://github.com/tombenke/rest-tool-common/blob/master/schemas/testCaseSchema.yml">testCaseSchema.yml</a></li>
</ul>
<h3 id="create-new-services">Create new services</h3>
<h4 id="add-new-service-to-the-project">Add new service to the project</h4>
<p>You can create a new service either manually creating and editing <code>service.yml</code> files, or using the <code>rest-tool</code> with the <code>add</code> and/or <code>add-bulk</code> command.</p>
<p>To add one service, you can use the <code>rest-tool add</code> command:</p>
<pre><code>$ rest-tool add -h

  Usage: add [options]

  Options:

    -h, --help                     output usage information
    -t, --type [type]              Defines the type (OPERATION|COLLECTION|RESOURCE) of the service (default: RESOURCE)
    -p, --path &lt;path&gt;              The path of the service description relative to project-root/service/
    -u, --urlPattern &lt;urlPattern&gt;  The unique URL pattern of the service
    -n, --name &lt;name&gt;              The name of the operation/collection/resource
    -d, --desc &lt;desc&gt;              The description of the service
    -c, --config [configFileName]  The name of the configuration file (default: config.yml)
    -v, --verbose                  Verbose mode
</code></pre><p>For example, to create a collection manager service, execute the following command:</p>
<pre><code>$ rest-tool add -t COLLECTION \
    -p customers \
    -u /customers \
    -n Customers \
    -d &quot;A service to manage the collection of customers&quot;
</code></pre><h4 id="service-stereotypes">Service stereotypes</h4>
<p>TBD:</p>
<ul>
<li>operation</li>
<li>collection</li>
<li>resource</li>
</ul>
<h4 id="add-new-service-to-the-project-in-bulk-mode">Add new service to the project in bulk mode</h4>
<p>It is also possible to create more than one service in one step with the <code>rest-tool add-bulk</code> command:</p>
<pre><code>$ rest-tool add-bulk -h

  Usage: add-bulk [options]

  Options:

    -h, --help                     output usage information
    -s, --services [services]      The filename of which contains the list of services to create (for example: bulk.json)
    -c, --config [configFileName]  The name of the configuration file (default: config.yml)
    -v, --verbose                  Verbose mode
</code></pre><!-- TODO: Show example, and demo bulk config file -->

<h3 id="configure-the-services">Configure the services</h3>
<p>The service descriptors you create will not be activated automatically. You have to manually list them under the <code>services</code> property of the <code>config.yml</code> file:</p>
<pre><code>services:
    - /monitoring/isAlive
    # To add new services, put here the path of the directory
    # that contains the service.yml
</code></pre><p>This way, you can write your new services until they will be stable enough to activate them, and they will be loaded and start working only if you have added them to the config file.</p>
<h3 id="create-mock-data">Create mock data</h3>
<p>Just simply put any files beside the <code>service.yml</code> and refer to them using the <code>mockBody</code> fields in the service descriptor.</p>
<h3 id="validation">Validation</h3>
<p>TBD.</p>
<h3 id="create-dynamic-mock-services">Create dynamic mock services</h3>
<p>TBD.</p>
<h2 id="using-the-server">Using the server</h2>
<h3 id="start-the-server">Start the server</h3>
<p>To start the mock server, execute the following command:</p>
<pre><code>$ node server/server.js
</code></pre><p>This will start a web server, which will listen on the localhost, and the port specified in the <code>config.yml</code> file (3007 by default).</p>
<p>After starting the server, you can can try it with a browser, or the <code>curl</code> command line tool:</p>
<pre><code>$ curl http://localhost:3007/rest/monitoring/isAlive
true
</code></pre><h3 id="use-as-static-mock-server">Use as static mock server</h3>
<p>TBD.</p>
<h3 id="use-as-static-content-provider-of-docs-and-webui">Use as static content provider of docs and webui</h3>
<p>TBD.</p>
<h3 id="add-new-modules-dynamic-service-implementations-">Add new modules (dynamic service implementations)</h3>
<p>TBD.</p>
<h3 id="use-as-proxy">Use as proxy</h3>
<p>TBD.</p>
<h2 id="documenting-the-rest-api-project">Documenting the REST API project</h2>
<h3 id="generate-documentation">Generate documentation</h3>
<p>To create or update the HTMl format documentation, execute the following command:</p>
<pre><code>$ rest-tool docs --update
</code></pre><p>This will create the documentation under the <code>docs</code> folder. the HTMl documentation can be opened via a browser directly as a static file, or through the mock server, loading the following URL: (<a href="http://localhost:3007/docs/index.html">http://localhost:3007/docs/index.html</a>).</p>
<p>Generate the documentation for the predefined service with the following command:</p>
<pre><code>$ rest-tool docs --update
</code></pre><p>The following files will be generated (in case of a new project):</p>
<pre><code>$ tree docs
docs
├── images
│   └── grid.png
├── index.html
├── js
│   ├── jquery-1.9.0
│   │   ├── jquery-1.9.0.js
│   │   └── jquery-1.9.0.min.js
│   └── restapidoc.js
├── README.md
├── sass
│   ├── ie.scss
│   ├── partials
│   │   └── _base.scss
│   ├── print.scss
│   └── screen.scss
├── services
│   └── monitoring
│       └── isAlive
│           ├── service.html
│           └── service.yml
└── stylesheets
    ├── ie.css
    ├── print.css
    └── screen.css
</code></pre><p>The generated documentation can be opened with a browser either as a static content 
opening the <code>docs/index.html</code> or through the server using the <code>http://localhost:3007/docs/</code> URL.</p>
<h3 id="customize-the-generated-documentation">Customize the generated documentation</h3>
<p>TBD.</p>
<ul>
<li>structure</li>
<li>look-and-feel</li>
</ul>
<h2 id="testing-the-api">Testing the api</h2>
<h3 id="generate-test-cases">Generate test cases</h3>
<p>Before you run the tests, you have to generate/update the test cases.
You can do this with the following command:</p>
<pre><code>$ rest-tool test --update --overwrite
</code></pre><p>The <code>--overwrite</code> option tells the tool to overwrite the existing cases, otherwise it will keep the if they exist yet.</p>
<h3 id="run-test-cases">Run test cases</h3>
<p>After the test cases is generated, you can run the tests, directly from the command line, or by the continuous integration server. Use one of the following commands:</p>
<pre><code>$ make test
</code></pre><p>or</p>
<pre><code>$ mocha
</code></pre><p>To select the appropriate reporting format for the continuous integration environment, modify the <code>Makefile</code>:</p>
<pre><code>REPORTER ?= spec

test:
    @node_modules/.bin/mocha --reporter $(REPORTER)

.PHONY: test
</code></pre><h3 id="add-new-test-case-templates">Add new test-case templates</h3>
<p>In case you would like to extend the test cases (for example to add JSON or XML validation), you should execute the following steps:</p>
<ol>
<li>Write a working sample test case, and try it to make sure, that is working properly.</li>
<li>Make a mustache template from it, and put into the <code>templates/test</code> folder.</li>
<li>Refer to it in the <code>service.yml</code> files using the <code>template</code> property of the testCases.</li>
</ol>
<p>During the test-case generation process, each template got the whole service description, and some additional data. </p>
<!-- TODO: describe additional fields for test-case generation. -->

        </div>
      </div>

      <div class="footer">
        <p class="copyright">rest-tool is maintained by <a href="https://github.com/tombenke">tombenke</a><br>
        Theme borrowed from <a href="http://getbootstrap.com/examples/jumbotron-narrow/">Bootstrap</a></p>
      </div>

    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
  </body>
</html>